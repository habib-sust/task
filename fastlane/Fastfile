default_platform(:ios)

platform :ios do

  ############## PRE ###################
  before_all do
	#ensure_git_status_clean(show_uncommitted_changes: true)
	sh 'mkdir ../test-reports || true'
  end


  ############# PUBLIC LANES ################
  lane :test do
    run_tests(
      scheme: "Task",
      code_coverage: true
    )
  end

  lane :lint do
    swiftlint(
	  mode: :lint,
	  reporter: "checkstyle",
	  output_file: "./test-reports/checkstyle-reports.xml",
	  config_file: "fastlane/.swiftlint.yml",
	  executable: "./Pods/SwiftLint/swiftlint"
       )
  end

  lane :coverage do
    slather(
	  scheme: "Task",
	  proj: "Task.xcodeproj",
	  workspace: "Task.workspace"
	)
  end 

end
